--IF $(OneTimeLoad) = 1
BEGIN

DECLARE @Section TABLE
(
    SectionKey INT NOT NULL PRIMARY KEY,
    PartKey INT NOT NULL,
    ParentSectionKey INT NULL,
    SectionName NVARCHAR(250) NOT NULL,
    PageReference NVARCHAR(50) NULL,
    DisplayOrder FLOAT NOT NULL,
    SectionSlug VARCHAR(50) NULL
        
);

INSERT INTO @Section
(
    SectionKey,
    PartKey,
    ParentSectionKey,
    SectionName,
    PageReference,
    DisplayOrder
    --SectionSlug
) VALUES


(5002, 8, NULL, N'Chapter 1: The Guards', NULL, 1),
(5003, 8, 5002, N'Guardia Alta', NULL, 1),
(5004, 8, 5002, N'Guardia di Testa', NULL, 2),
(5005, 8, 5002, N'Guardia di Faccia', NULL, 3),
(5006, 8, 5002, N'Guardia di Sopra il Braccio', NULL, 4),
(5007, 8, 5002, N'Guardia di Soto il Braccio', NULL, 5),
(5008, 8, 5002, N'Guardia di Porta di Fero Stretta', NULL, 6),
(5009, 8, 5002, N'Guardia di Porta di Fero Larga', NULL, 7),
(5010, 8, 5002, N'Chinghiara Porta di Fero', NULL, 8),
(5011, 8, 5002, N'Coda Lunga e Alta', NULL, 9),
(5012, 8, 5002, N'Coda Lunga e Stretta', NULL, 10),
(5013, 8, NULL, N'Chapter 2: The Blows', NULL, 2),
(5014, 8, NULL, N'Chapter 3: Guardia Alta', NULL, 3),
(5015, 8, 5014, N'Guardia Alta 1', NULL, 1),
(5016, 8, 5014, N'Guardia Alta 2', NULL, 2),
(5017, 8, 5014, N'Guardia Alta 3', NULL, 3),
(5018, 8, 5014, N'Guardia Alta 4', NULL, 4),
(5019, 8, 5014, N'Guardia Alta 5', NULL, 5),
(5020, 8, 5014, N'Guardia Alta 6', NULL, 6),
(5021, 8, 5014, N'Guardia Alta 7', NULL, 7),
(5022, 8, 5014, N'Guardia Alta 8', NULL, 8),
(5023, 8, 5014, N'Guardia Alta 9', NULL, 9),
(5024, 8, NULL, N'Chapter 5/6: Guardia di Testa', NULL, 4),
(5025, 8, 5024, N'Guardia di Testa 1', NULL, 1),
(5026, 8, 5024, N'Guardia di Testa 2', NULL, 2),
(5027, 8, 5024, N'Guardia di Testa 3', NULL, 3),
(5028, 8, 5024, N'Guardia di Testa 4', NULL, 4),
(5029, 8, 5024, N'Guardia di Testa 5', NULL, 5),
(5030, 8, NULL, N'Chapter 7/8: Guardia di Faccia', NULL, 5),
(5031, 8, 5030, N'Guardia di Faccia 1', NULL, 1),
(5032, 8, 5030, N'Guardia di Faccia 2', NULL, 2),
(5033, 8, 5030, N'Guardia di Faccia 3', NULL, 3),
(5034, 8, 5030, N'Guardia di Faccia 4', NULL, 4),
(5035, 8, 5030, N'Guardia di Faccia 5', NULL, 5),
(5036, 8, NULL, N'Chapter 9/10: Guardia di Sopra il Braccio', NULL, 6),
(5037, 8, 5036, N'Sopra il Braccio 1', NULL, 1),
(5038, 8, 5036, N'Sopra il Braccio 2', NULL, 2),
(5039, 8, 5036, N'Sopra il Braccio 3', NULL, 3),
(5040, 8, 5036, N'Sopra il Braccio 4', NULL, 4),
(5041, 8, 5036, N'Sopra il Braccio 5', NULL, 5),
(5042, 8, 5036, N'Sopra il Braccio 6', NULL, 6),
(5043, 8, 5036, N'Sopra il Braccio 7', NULL, 7),
(5044, 8, 5036, N'Sopra il Braccio 8', NULL, 8),
(5045, 8, 5036, N'Sopra il Braccio 9', NULL, 9),
(5046, 8, 5036, N'Sopra il Braccio 10', NULL, 10),
(5047, 8, NULL, N'Chapter 11/12: Guardia di Sotto il Braccio', NULL, 7),
(5048, 8, 5047, N'Sotto il Braccio 1', NULL, 1),
(5049, 8, 5047, N'Sotto il Braccio 2', NULL, 2),
(5050, 8, 5047, N'Sotto il Braccio 3', NULL, 3),
(5051, 8, 5047, N'Sotto il Braccio 4', NULL, 4),
(5052, 8, 5047, N'Sotto il Braccio 5', NULL, 5),
(5053, 8, NULL, N'Chapter 13/14: Porta di Ferro Stretta', NULL, 8),
(5054, 8, 5053, N'Porta di Ferro Stretta 1', NULL, 1),
(5055, 8, 5053, N'Porta di Ferro Stretta 2', NULL, 2),
(5056, 8, 5053, N'Porta di Ferro Stretta 3', NULL, 3),
(5057, 8, 5053, N'Porta di Ferro Stretta 4', NULL, 4),
(5058, 8, 5053, N'Porta di Ferro Stretta 5', NULL, 5),
(5059, 8, NULL, N'Chapter 15/16: Porta di Ferro Larga', NULL, 9),
(5060, 8, 5059, N'Porta di Ferro Larga 1', NULL, 1),
(5061, 8, 5059, N'Porta di Ferro Larga 2', NULL, 2),
(5062, 8, 5059, N'Porta di Ferro Larga 3', NULL, 3),
(5063, 8, 5059, N'Porta di Ferro Larga 4', NULL, 4),
(5064, 8, 5059, N'Porta di Ferro Larga 5', NULL, 5),
(5065, 8, 5059, N'Porta di Ferro Larga 6', NULL, 6),
(5066, 8, 5059, N'Porta di Ferro Larga 7', NULL, 7),
(5067, 8, NULL, N'Chapter 17/18: Cinghiara Porta di Ferro', NULL, 10),
(5068, 8, 5067, N'Cinghiara Porta di Ferro 1', NULL, 1),
(5069, 8, 5067, N'Cinghiara Porta di Ferro 2', NULL, 2),
(5070, 8, 5067, N'Cinghiara Porta di Ferro 3', NULL, 3),
(5071, 8, 5067, N'Cinghiara Porta di Ferro 4', NULL, 4),
(5072, 8, 5067, N'Cinghiara Porta di Ferro 5', NULL, 5),
(5073, 8, 5067, N'Cinghiara Porta di Ferro 6', NULL, 6),
(5074, 8, 5067, N'Cinghiara Porta di Ferro 7', NULL, 7),
(5075, 8, 5067, N'Cinghiara Porta di Ferro 8', NULL, 8),
(5076, 8, NULL, N'Chapter 19/20: Coda Lunga e Alta', NULL, 11),
(5077, 8, 5076, N'Coda Lunga e Alta 1', NULL, 1),
(5078, 8, 5076, N'Coda Lunga e Alta 2', NULL, 2),
(5079, 8, 5076, N'Coda Lunga e Alta 3', NULL, 3),
(5080, 8, 5076, N'Coda Lunga e Alta 4', NULL, 4),
(5081, 8, 5076, N'Coda Lunga e Alta 5', NULL, 5),
(5082, 8, 5076, N'Coda Lunga e Alta 6', NULL, 6),
(5083, 8, 5076, N'Coda Lunga e Alta 7', NULL, 7),
(5084, 8, NULL, N'Chapter 21/22: Coda Lunga e Stretta', NULL, 12),
(5085, 8, 5084, N'Coda Lunga e Stretta 1', NULL, 1),
(5086, 8, 5084, N'Coda Lunga e Stretta 2', NULL, 2),
(5087, 8, 5084, N'Coda Lunga e Stretta 3', NULL, 3),
(5088, 8, 5084, N'Coda Lunga e Stretta 4', NULL, 4),


(5090, 9, NULL, N'Sword and Buckler Assault 1', NULL, 1),
(5091, 9, 5090, N'Assault 1 Part 1 (Opening)', NULL, 1),
(5092, 9, 5090, N'Assault 1 Part 1 (Embellishment)', NULL, 2),
(5093, 9, 5090, N'Assault 1 Part 2 (First Combat, 1-10)', NULL, 3),
(5094, 9, 5090, N'Assault 1 Part 3 (Second Combat, 11-20)', NULL, 4),
(5095, 9, 5090, N'Assault 1 Part 4 (Third Combat, 22-26)', NULL, 5),
(5096, 9, 5090, N'Assault 1 Part 5 (Fourth Combat, 27-31)', NULL, 6),
(5097, 9, 5090, N'Assault 1 Part 6 (Retreat)', NULL, 7),
(5098, 9, NULL, N'Sword and Buckler Assault 2', NULL, 2),
(5099, 9, 5098, N'Assault 2 Part 1 (Opening)', NULL, 1),
(5100, 9, 5098, N'Assault 1 Part 2 (Embellishment)', NULL, 2),
(5101, 9, 5098, N'Assault 2 Part 2 (First Combat, 1-14)', NULL, 3),
(5102, 9, 5098, N'Assault 2 Part 3 (Second Combat, 15-24)', NULL, 4),
(5103, 9, 5098, N'Assault 2 Part 4 (Third Combat, 25-43)', NULL, 5),
(5104, 9, 5098, N'Assault 2 Part 5 (Retreat)', NULL, 6),
(5105, 9, NULL, N'Sword and Buckler Assault 3', NULL, 3),
(5106, 9, 5105, N'Assault 3 Part 1 (Opening)', NULL, 1),
(5107, 9, 5105, N'Assault 1 Part 3 (Embellishment)', NULL, 2),
(5108, 9, 5105, N'Assault 3 Part 2 (First Combat, 1-10)', NULL, 3),
(5109, 9, 5105, N'Assault 3 Part 3 (Second Combat, 11-19)', NULL, 4),
(5110, 9, 5105, N'Assault 3 Part 4 (Third Combat, 20-30)', NULL, 5),
(5111, 9, 5105, N'Assault 3 Part 5 (Fourth Combat, 31-52)', NULL, 6),
(5112, 9, 5105, N'Assault 3 Part 6 (Fifth Combat, 53-64)', NULL, 7),
(5113, 9, 5105, N'Assault 3 Part 7 (Sixth Combat, 65-71)', NULL, 8),
(5114, 9, 5105, N'Assault 3 Part 8 (Retreat)', NULL, 9),


(5116, 10, NULL, N'False Stretta', NULL, 1),
(5117, 10, 5116, N'False Stretta 1', NULL, 1),
(5118, 10, 5116, N'False Stretta 2', NULL, 2),
(5119, 10, 5116, N'False Stretta 3', NULL, 3),
(5120, 10, 5116, N'False Stretta 4', NULL, 4),
(5121, 10, 5116, N'False Stretta 5', NULL, 5),
(5122, 10, 5116, N'False Stretta 6', NULL, 6),
(5123, 10, 5116, N'False Stretta 7', NULL, 7),
(5124, 10, 5116, N'False Stretta 8', NULL, 8),
(5125, 10, 5116, N'False Stretta 9', NULL, 9),
(5126, 10, 5116, N'False Stretta 10', NULL, 10),
(5127, 10, 5116, N'False Stretta 11', NULL, 11),
(5128, 10, 5116, N'False Stretta 12', NULL, 12),
(5129, 10, 5116, N'False Stretta 13', NULL, 13),
(5130, 10, 5116, N'False Stretta 14', NULL, 14),
(5131, 10, 5116, N'False Stretta 15', NULL, 15),
(5132, 10, 5116, N'False Stretta 16', NULL, 16),
(5133, 10, 5116, N'False Stretta 17', NULL, 17),
(5134, 10, NULL, N'True Stretta', NULL, 2),
(5135, 10, 5134, N'True Stretta 1', NULL, 1),
(5136, 10, 5134, N'True Stretta 2', NULL, 2),
(5137, 10, 5134, N'True Stretta 3', NULL, 3),
(5138, 10, 5134, N'True Stretta 4', NULL, 4),
(5139, 10, 5134, N'True Stretta 5', NULL, 5),
(5140, 10, 5134, N'True Stretta 6', NULL, 6),
(5141, 10, 5134, N'True Stretta 7', NULL, 7),
(5142, 10, 5134, N'True Stretta 8', NULL, 8),
(5143, 10, 5134, N'True Stretta 9', NULL, 9),
(5144, 10, 5134, N'True Stretta 10', NULL, 10),
(5145, 10, 5134, N'True Stretta 11', NULL, 11),
(5146, 10, 5134, N'True Stretta 12', NULL, 12),
(5147, 10, 5134, N'True Stretta 13', NULL, 13),
(5148, 10, 5134, N'True Stretta 14', NULL, 14),
(5149, 10, 5134, N'True Stretta 15', NULL, 15),
(5150, 10, 5134, N'True Stretta 16', NULL, 16),
(5151, 10, 5134, N'True Stretta 17', NULL, 17),


(5153, 11, NULL, N'Sword and Large Buckler', NULL, 1),
(5154, 11, 5153, N'Chapter 1 thru 3: Coda Lunga e Alta', NULL, 1),
(5155, 11, 5154, N'Chapter 1 Part A Counter 1', NULL, 1),
(5156, 11, 5154, N'Chapter 1 Part A Counter 2', NULL, 2),
(5157, 11, 5154, N'Chapter 1 Part A Counter 3', NULL, 3),
(5158, 11, 5154, N'Chapter 1 Part A Counter 4', NULL, 4),
(5159, 11, 5154, N'Chapter 1 Part A Counter 5', NULL, 5),
(5160, 11, 5154, N'Chapter 1 Part B Counter 1', NULL, 6),
(5161, 11, 5154, N'Chapter 1 Part B Counter 2', NULL, 7),
(5162, 11, 5154, N'Chapter 1 Part B Counter 3', NULL, 8),
(5163, 11, 5154, N'Chapter 1 Part B Counter 4', NULL, 9),
(5164, 11, 5154, N'Chapter 1 Part B Counter 5', NULL, 10),
(5165, 11, 5154, N'Chapter 1 Part B Counter 6', NULL, 11),
(5166, 11, 5154, N'Chapter 2', NULL, 12),
(5167, 11, 5154, N'Chapter 3 Play 1', NULL, 13),
(5168, 11, 5154, N'Chapter 3 Play 2', NULL, 14),
(5169, 11, 5154, N'Chapter 3 Play 3', NULL, 15),
(5170, 11, 5153, N'Chapter 4 thru 7: Coda Lunga e Stretta', NULL, 2),
(5171, 11, 5170, N'Chapter 4', NULL, 1),
(5172, 11, 5170, N'Chapter 5', NULL, 2),
(5173, 11, 5170, N'Chapter 6', NULL, 3),
(5174, 11, 5170, N'Chapter 7', NULL, 4),
(5175, 11, 5153, N'Chapter 8: Cinghiara Porta di Ferro', NULL, 3),
(5176, 11, 5175, N'Chapter 8 Play 1', NULL, 1),
(5177, 11, 5175, N'Chapter 8 Play 2', NULL, 2),
(5178, 11, 5175, N'Chapter 8 Play 3', NULL, 3),
(5179, 11, 5175, N'Chapter 8 Play 4', NULL, 4),
(5180, 11, 5175, N'Chapter 8 Play 5', NULL, 5),
(5181, 11, 5175, N'Chapter 8 Play 6', NULL, 6),
(5182, 11, 5175, N'Chapter 8 Play 7', NULL, 7),
(5183, 11, 5153, N'Chapter 9: Cinghiara Porta di Stretta', NULL, 4),
(5184, 11, 5183, N'Chapter 9 Play 1', NULL, 1),
(5185, 11, 5183, N'Chapter 9 Play 2', NULL, 2),
(5186, 11, 5183, N'Chapter 9 Play 3', NULL, 3),
(5187, 11, 5183, N'Chapter 9 Play 4', NULL, 4),
(5188, 11, 5183, N'Chapter 9 Play 5', NULL, 5),
(5189, 11, 5183, N'Chapter 9 Play 6', NULL, 6),
(5190, 11, 5183, N'Chapter 9 Play 7', NULL, 7),
(5191, 11, 5183, N'Chapter 9 Play 8', NULL, 8),
(5192, 11, 5153, N'Chapter 10', NULL, 5),
(5193, 11, 5192, N'Play 1 (Coda Lunga e Alta', NULL, 1),
(5194, 11, 5192, N'Play 2', NULL, 2),
(5195, 11, 5192, N'Play 3', NULL, 3),
(5196, 11, 5192, N'Play 4', NULL, 4),
(5197, 11, 5192, N'Play 5', NULL, 5),
(5198, 11, 5192, N'Play 6', NULL, 6),
(5199, 11, 5192, N'Play 7', NULL, 7),
(5200, 11, 5192, N'Play 8 (vs left-handed fencer)', NULL, 8),
(5201, 11, 5192, N'Play 9', NULL, 9),
(5202, 11, 5192, N'Play 10 (vs right-handed fencer)', NULL, 10),
(5203, 11, 5192, N'Play 11', NULL, 11),
(5204, 11, 5192, N'Play 12 (Coda Lunga e Alta', NULL, 12),
(5205, 11, NULL, N'Two Swords', NULL, 2),
(5206, 11, 5205, N'Part 1 (Opening)', NULL, 1),
(5207, 11, 5205, N'Part 2 (Combat)', NULL, 2),
(5208, 11, 5205, N'Part 3 (Retreat)', NULL, 3),
(5209, 11, NULL, N'Sword Alone', NULL, 3),
(5210, 11, 5209, N'Play 1', NULL, 1),
(5211, 11, 5209, N'Play 2', NULL, 2),
(5212, 11, 5209, N'Play 3', NULL, 3),
(5213, 11, 5209, N'Play 4', NULL, 4),
(5214, 11, 5209, N'Play 5', NULL, 5),
(5215, 11, 5209, N'Play 6', NULL, 6),


(5217, 12, NULL, N'Sword and Cape', NULL, 1),
(5218, 12, 5217, N'Coda Lunga e Alta 2', NULL, 1),
(5219, 12, 5217, N'Coda Lunga e Alta 3', NULL, 2),
(5220, 12, 5217, N'Coda Lunga e Alta 4', NULL, 3),
(5221, 12, 5217, N'Coda Lunga e Alta 5', NULL, 4),
(5222, 12, 5217, N'Coda Lunga e Alta 6', NULL, 5),
(5223, 12, 5217, N'Coda Lunga e Alta 7', NULL, 6),
(5224, 12, 5217, N'Coda Lunga e Alta 8', NULL, 7),
(5225, 12, 5217, N'Coda Lunga e Alta 9', NULL, 8),
(5226, 12, 5217, N'Coda Lunga e Alta 10', NULL, 9),
(5227, 12, 5217, N'Coda Lunga e Alta 11', NULL, 10),
(5228, 12, 5217, N'Coda Lunga e Stretta 1', NULL, 11),
(5229, 12, 5217, N'Coda Lunga e Stretta 2', NULL, 12),
(5230, 12, 5217, N'Coda Lunga e Stretta 3', NULL, 13),
(5231, 12, 5217, N'Coda Lunga e Stretta 4', NULL, 14),
(5232, 12, 5217, N'Coda Lunga e Stretta 5', NULL, 15),
(5233, 12, 5217, N'Coda Lunga e Stretta 6', NULL, 16),
(5234, 12, 5217, N'Coda Lunga e Stretta 7', NULL, 17),
(5235, 12, 5217, N'Two on Two', NULL, 18),
(5236, 12, NULL, N'Sword and Dagger', NULL, 2),
(5237, 12, 5236, N'Coda Dagger 2', NULL, 1),
(5238, 12, 5236, N'Coda Dagger 3', NULL, 2),
(5239, 12, 5236, N'Coda Dagger 4', NULL, 3),
(5240, 12, 5236, N'Coda Dagger 5', NULL, 4),
(5241, 12, NULL, N'Sword and Rotella', NULL, 3),
(5242, 12, 5241, N'Part 1 (Opening)', NULL, 1),
(5243, 12, 5241, N'Part 2 (Combat)', NULL, 2),
(5244, 12, 5241, N'Part 3 (Retreat)', NULL, 3),


(5246, 13, NULL, N'Play of Rotella and Partisan', NULL, 1),
(5247, 13, 5246, N'Play 1', NULL, 1),
(5248, 13, 5246, N'Play 2', NULL, 2),
(5249, 13, 5246, N'Play 3', NULL, 3),
(5250, 13, 5246, N'Play 4', NULL, 4),
(5251, 13, 5246, N'Play 5', NULL, 5),
(5252, 13, NULL, N'Another Play of Rotella and Partisan', NULL, 2),
(5253, 13, 5252, N'Play 1', NULL, 1),
(5254, 13, 5252, N'Play 2', NULL, 2),
(5255, 13, 5252, N'Play 3', NULL, 3),
(5256, 13, NULL, N'Play of Single Partisan', NULL, 3),
(5257, 13, 5256, N'Play 1', NULL, 1),
(5258, 13, 5256, N'Play 2', NULL, 2),
(5259, 13, 5256, N'Play 3', NULL, 3),
(5260, 13, 5256, N'Play 4', NULL, 4),
(5261, 13, NULL, N'Play of Spiedo against Spiedo', NULL, 4),
(5262, 13, 5261, N'Play 1', NULL, 1),
(5263, 13, 5261, N'Play 2', NULL, 2),
(5264, 13, NULL, N'Play of Ronca against Ronca', NULL, 5),
(5265, 13, 5264, N'Play 1', NULL, 1),
(5266, 13, 5264, N'Play 2', NULL, 2),
(5267, 13, 5264, N'Play 3', NULL, 3),
(5268, 13, 5264, N'Play 4', NULL, 4),
(5269, 13, NULL, N'Play of Hand-held Spears', NULL, 6),
(5270, 13, 5269, N'Play 1', NULL, 1),
(5271, 13, 5269, N'Play 2', NULL, 2),
(5272, 13, 5269, N'Play 3', NULL, 3),
(5273, 13, 5269, N'Play 4', NULL, 4),
(5274, 13, 5269, N'Play 5', NULL, 5),
(5275, 13, 5269, N'Play 6 (Counter to 5)', NULL, 6),
(5276, 13, 5269, N'Play 7', NULL, 7),
(5277, 13, 5269, N'Play 8', NULL, 8),
(5278, 13, 5269, N'Play 9 (Counter to 8)', NULL, 9),
(5279, 13, 5269, N'Play 10', NULL, 10),
(5280, 13, 5269, N'Play 11', NULL, 11)

;


MERGE INTO Sources.Section t
USING @Section s
ON t.SectionKey = s.SectionKey
WHEN NOT MATCHED THEN
    INSERT
(  SectionKey,
PartKey,
ParentSectionKey,
SectionName,
PageReference,
DisplayOrder )
    VALUES
    (  s.SectionKey,
s.PartKey,
s.ParentSectionKey,
s.SectionName,
s.PageReference,
s.DisplayOrder )
WHEN MATCHED THEN
    UPDATE SET  PartKey = s.PartKey,
ParentSectionKey = s.ParentSectionKey,
SectionName = s.SectionName,
PageReference = s.PageReference,
DisplayOrder = s.DisplayOrder;

END;
GO
